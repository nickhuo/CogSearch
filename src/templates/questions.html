<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Comprehension Questions</title>
  <base target="_top">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
</head>
<body>
<div class="container">
    <h2>Comprehension Questions</h2>

    {% if not questions_by_passage %}
      <p>No comprehension questions are available at this time.</p>
    {% else %}
    <form method="POST" action="{{ url_for('core.done') }}">
        {% set counter = namespace(value=1) %}
        {% for block in questions_by_passage %}
          {% for q in block.questions %}
          <div class="card mb-4">
            <div class="card-header">Question {{ counter.value }}</div>
            <div class="card-body">
                <p class="card-text">{{ q.questionText }}</p>
                
                <div class="form-check">
                    <input class="form-check-input" type="radio" 
                           name="q_{{ q.questionID }}" value="a" required
                           {% if existing_answers.get(q.questionID) == 'a' %}checked{% endif %}>
                    <label class="form-check-label">
                        {{ q.choiceA }}
                    </label>
                </div>

                <div class="form-check">
                    <input class="form-check-input" type="radio" 
                           name="q_{{ q.questionID }}" value="b"
                           {% if existing_answers.get(q.questionID) == 'b' %}checked{% endif %}>
                    <label class="form-check-label">
                        {{ q.choiceB }}
                    </label>
                </div>

                {% if q.choiceC %}
                <div class="form-check">
                    <input class="form-check-input" type="radio" 
                           name="q_{{ q.questionID }}" value="c"
                           {% if existing_answers.get(q.questionID) == 'c' %}checked{% endif %}>
                    <label class="form-check-label">
                        {{ q.choiceC }}
                    </label>
                </div>
                {% endif %}

                {% if q.choiceD %}
                <div class="form-check">
                    <input class="form-check-input" type="radio" 
                           name="q_{{ q.questionID }}" value="d"
                           {% if existing_answers.get(q.questionID) == 'd' %}checked{% endif %}>
                    <label class="form-check-label">
                        {{ q.choiceD }}
                    </label>
                </div>
                {% endif %}
            </div>
          </div>
          {% set counter.value = counter.value + 1 %}
          {% endfor %}
        {% endfor %}
        
        <div class="mt-4">
            <button type="submit" class="btn btn-primary btn-lg">
                Submit Answers and Finish
            </button>
        </div>
    </form>
    {% endif %}
</div>
</body>
</html>
